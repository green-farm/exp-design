var col,row,num,numA,numB;
$(document).ready(function(){$("#createBtn").click(function(){$("#dataForm").empty();num=parseInt($("#num1").find(":selected").text());numA=parseInt($("#num2").find(":selected").text());numB=parseInt($("#num3").find(":selected").text());row=numA*numB;var h='<input type="text" class="row" disabled/>',c,f;for(c=0;c<num;c++)switch(c){case 0:h+='<input type="text" class="col" id="col1" value="I" disabled/>';break;case 1:h+='<input type="text" class="col" id="col2" value="II" disabled/>';break;case 2:h+=
'<input type="text" class="col" id="col3" value="III" disabled/>';break;case 3:h+='<input type="text" class="col" id="col4" value="IV" disabled/>';break;case 4:h+='<input type="text" class="col" id="col5" value="V" disabled/>';break;case 5:h+='<input type="text" class="col" id="col6" value="VI" disabled/>';break;default:h+='<input type="text" class="col" id="col1" value="I" disabled/>'}var l="";for(c=0;c<numA;c++)l+="<option>A"+(c+1)+"</option>";var m="";for(c=0;c<numB;c++)m+="<option>B"+(c+1)+"</option>";
h+="<br>";for(f=1;f<=row;f++){h+='<input class="row" value="'+f+'" disabled></input>';for(c=1;c<=num;c++)h+='<select class="2FactorsSelect" id="a'+c+""+f+'" style="text-align-last:right;width:40px;height:25px;margin-left: 0px;margin-right: 0px;">'+l+"</select>",h+='<select class="2FactorsSelect" id="b'+c+""+f+'" style="text-align-last:right;width:40px;height:25px;margin-left: 0px;margin-right: 0px;">'+m+"</select>";h+="<br>";h+='<input type="text" class="row" disabled></input>';for(c=1;c<=num;c++)h+=
'<input class="data" type="text" id="'+c+""+f+'"/>';h+="<br>"}$("#dataForm").append(h)});$("#anovaBtn").click(function(){var h=0,c=Array(num),f=Array(num),l=Array(num),m=Array(num),a,b;for(a=0;a<num;a++)c[a]=Array(row),f[a]=Array(row),l[a]=Array(row),m[a]=Array(row);for(b=0;b<num;b++)for(a=0;a<row;a++)f[b][a]=Array(2);for(b=0;b<row;b++)for(a=0;a<num;a++)c[a][b]=parseFloat($("#"+(a+1)+""+(b+1)).val()),h+=c[a][b],l[a][b]=$("#a"+(a+1)+""+(b+1)).find(":selected").text(),m[a][b]=$("#b"+(a+1)+""+(b+1)).find(":selected").text(),
f[a][b][0]=$("#a"+(a+1)+""+(b+1)+" option:selected").index(),f[a][b][1]=$("#b"+(a+1)+""+(b+1)+" option:selected").index();l=Array(numA);m=Array(numB);for(a=0;a<numA;a++)l[a]=0;for(a=0;a<numB;a++)m[a]=0;for(b=0;b<row;b++)for(a=0;a<num;a++)l[f[a][b][0]]+=c[a][b],m[f[a][b][1]]+=c[a][b];a=num*numA*numB;var d=Array(6);d[0]=a-1;d[1]=num-1;d[2]=numA-1;d[3]=numB-1;d[4]=d[2]*d[3];d[5]=d[0]-d[1]-d[2]-d[3]-d[4];$("#df1").text(d[0]);$("#df2").text(d[1]);$("#df3").text(d[2]);$("#df4").text(d[3]);$("#df5").text(d[4]);
$("#df6").text(d[5]);var n=Math.round(h*h/a*100)/100;var e=0;for(b=0;b<row;b++)for(a=0;a<num;a++)e+=c[a][b]*c[a][b];var g=Array(5);g[0]=e-n;$("#ss1").text(Math.round(100*g[0])/100);var k=Array(num);for(a=e=0;a<num;a++){for(b=k[a]=0;b<row;b++)k[a]+=c[a][b];e+=k[a]*k[a]}e=Math.round(e/row*100)/100;g[1]=e-n;$("#ss2").text(Math.round(100*g[1])/100);b='<input type="text" class="row" value="sum" disabled/>';for(a=0;a<num;a++)b+='<input type="text" class="sum" value="'+Math.round(100*k[a])/100+'" disabled/>';
b+='<br/><input type="text" class="row" value="mean" disabled/>';e=Array(num);var p=numA*numB;for(a=0;a<num;a++)e[a]=k[a]/p,b+='<input type="text" class="mean" value="'+Math.round(100*e[a])/100+'" disabled/>';$("#dataForm").append(b);for(a=e=0;a<numA;a++)e+=l[a]*l[a];e=Math.round(e/(num*numB)*100)/100;g[2]=e-n;$("#ss3").text(Math.round(100*g[2])/100);for(a=e=0;a<numB;a++)e+=m[a]*m[a];e=Math.round(e/(num*numA)*100)/100;g[3]=e-n;$("#ss4").text(Math.round(100*g[3])/100);k=Array(numA);for(a=0;a<numA;a++)k[a]=
Array(numB);for(b=0;b<numB;b++)for(a=0;a<numA;a++)k[a][b]=0;for(b=0;b<row;b++)for(a=0;a<num;a++)k[f[a][b][0]][f[a][b][1]]+=c[a][b];for(b=e=0;b<numB;b++)for(a=0;a<numA;a++)e+=k[a][b]*k[a][b];g[4]=e/num-n-g[3]-g[2];$("#ss5").text(Math.round(100*g[4])/100);g[5]=g[0]-g[1]-g[2]-g[3]-g[4];$("#ss6").text(Math.round(100*g[5])/100);a=Array(5);a[0]=g[1]/d[1];a[1]=g[2]/d[2];a[2]=g[3]/d[3];a[3]=g[4]/d[4];a[4]=g[5]/d[5];$("#ms2").text(Math.round(100*a[0])/100);$("#ms3").text(Math.round(100*a[1])/100);$("#ms4").text(Math.round(100*
a[2])/100);$("#ms5").text(Math.round(100*a[3])/100);$("#ms6").text(Math.round(100*a[4])/100);c=Math.round(a[0]/a[4]*100)/100;f=Math.round(a[1]/a[4]*100)/100;d=Math.round(a[2]/a[4]*100)/100;a=Math.round(a[3]/a[4]*100)/100;$("#f2").text(c);$("#f3").text(f);$("#f4").text(d);$("#f5").text(a);for(b=0;b<numB;b++)for(a=0;a<numA;a++)e=Math.round(100*k[a][b])/100,$("#a"+(a+1)+"b"+(b+1)).text(e);d=Array(numA);c=Array(numB);b=num*numB;f=num*numA;for(a=0;a<numA;a++)$("#sumA"+(a+1)).text(Math.round(100*l[a])/
100),d[a]=l[a]/b,$("#meanA"+(a+1)).text(Math.round(100*d[a])/100);for(b=0;b<numB;b++)$("#sumB"+(b+1)).text(Math.round(100*m[b])/100),c[b]=m[b]/f,$("#meanB"+(b+1)).text(Math.round(100*c[b])/100);$("#sumTot").text(Math.round(100*h)/100)})});