var col,row,num;
$(document).ready(function(){$("#createBtn").click(function(){$("#dataForm").empty();num=parseInt($("#num1").find(":selected").text());var c='<input type="text" class="row" disabled/>',g,a;for(g=0;g<num;g++)switch(g){case 0:c+='<input type="text" class="col" id="col1" value="I" disabled/>';break;case 1:c+='<input type="text" class="col" id="col2" value="II" disabled/>';break;case 2:c+='<input type="text" class="col" id="col3" value="III" disabled/>';break;case 3:c+='<input type="text" class="col" id="col4" value="IV" disabled/>';break;
case 4:c+='<input type="text" class="col" id="col5" value="V" disabled/>';break;case 5:c+='<input type="text" class="col" id="col6" value="VI" disabled/>';break;default:c+='<input type="text" class="col" id="col1" value="I" disabled/>'}c+="<br>";var b="";switch(num){case 3:b+="<option>A</option><option>B</option><option>C</option>";break;case 4:b+="<option>A</option><option>B</option><option>C</option><option>D</option>";break;case 5:b+="<option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>";
break;default:b+="<option>A</option><option>B</option>"}for(a=1;a<=num;a++){c+='<input class="row" value="'+a+'" disabled></input>';for(g=1;g<=num;g++)c+='<select class="abcSelect" id="s'+g+""+a+'" style="text-align-last:right;width:80px;height:25px;margin-left: 0px;margin-right: 0px;">'+b+"</select>";c+="<br>";c+='<input type="text" class="row" disabled></input>';for(g=1;g<=num;g++)c+='<input class="data" type="text" id="'+g+""+a+'"/>';c+="<br>"}$("#dataForm").append(c)});$("#anovaBtn").click(function(){var c=
Array(num),g=Array(num),a,b;for(a=0;a<num;a++)c[a]=Array(num),g[a]=Array(num);for(b=0;b<num;b++)for(a=0;a<num;a++)c[a][b]=parseFloat($("#"+(a+1)+""+(b+1)).val()),g[a][b]=$("#s"+(a+1)+""+(b+1)).find(":selected").text();var f=Array(num),k=Array(num),d=0;for(a=0;a<num;a++){for(b=f[a]=0;b<num;b++)f[a]+=c[a][b];k[a]=Math.round(f[a]/num*100)/100;d+=f[a]}var e='<input type="text" class="row" value="sum" disabled/>';for(a=0;a<num;a++)e+='<input type="text" class="sum" value="'+f[a]+'" disabled/>';d=Math.round(100*
d)/100;e=e+('<input type="text" class="sum" value="'+d+'" disabled/>')+'<br><input type="text" class="row" value="mean" disabled/>';for(a=0;a<num;a++)e+='<input type="text" class="mean" value="'+k[a]+'" disabled/>';e+='<input type="text" class="mean" value="'+Math.round(d/(num*num)*100)/100+'" disabled/>';$("#dataForm").append(e);k=Array(num);d=Array(num);for(b=0;b<num;b++){for(a=k[b]=0;a<num;a++)k[b]+=c[a][b];d[b]=Math.round(k[b]/num*100)/100}$("#col"+num).after('<input type="text" class="col" value="s & m" disabled/>');
for(b=0;b<num;b++)e='<input type="text" class="sum" value="'+k[b]+'" disabled/>',$("#s"+num+""+(b+1)).after(e),e='<input type="text" class="mean" value="'+d[b]+'" disabled/>',$("#"+num+""+(b+1)).after(e);e=Array(5);e[0]=num*num-1;e[1]=num-1;e[2]=num-1;e[3]=num-1;e[4]=e[0]-e[1]-e[2]-e[3];$("#df1").text(e[0]);$("#df2").text(e[1]);$("#df3").text(e[2]);$("#df4").text(e[3]);$("#df5").text(e[4]);var l=0;for(a=0;a<num;a++)l+=f[a];l=Math.round(l*l/(num*num)*100)/100;var h=0;for(b=0;b<num;b++)for(a=0;a<num;a++)h+=
c[a][b]*c[a][b];d=Array(5);d[0]=h-l;d[0]=Math.round(100*d[0])/100;$("#ss1").text(d[0]);for(a=h=0;a<num;a++)h+=k[a]*k[a];d[1]=Math.round(h/num*100)/100-l;d[1]=Math.round(100*d[1])/100;$("#ss2").text(d[1]);for(a=h=0;a<num;a++)h+=f[a]*f[a];h=Math.round(h/num*100)/100;d[2]=h-l;d[2]=Math.round(100*d[2])/100;$("#ss3").text(d[2]);f=Array(num);k=Array(num);for(a=0;a<num;a++)f[a]=0;for(a=0;a<num;a++)for(b=0;b<num;b++)switch(g[a][b]){case "A":f[0]+=c[a][b];break;case "B":f[1]+=c[a][b];break;case "C":f[2]+=
c[a][b];break;case "D":f[3]+=c[a][b];break;case "E":f[4]+=c[a][b]}for(a=h=0;a<num;a++)h+=f[a]*f[a],k[a]=Math.round(f[a]/num*100)/100;h=Math.round(h/num*100)/100;d[3]=h-l;d[3]=Math.round(100*d[3])/100;$("#ss4").text(d[3]);d[4]=d[0]-d[1]-d[2]-d[3];d[4]=Math.round(100*d[4])/100;$("#ss5").text(d[4]);c=Array(4);c[0]=Math.round(d[1]/e[1]*100)/100;c[1]=Math.round(d[2]/e[2]*100)/100;c[2]=Math.round(d[3]/e[3]*100)/100;c[3]=Math.round(d[4]/e[4]*100)/100;$("#ms2").text(c[0]);$("#ms3").text(c[1]);$("#ms4").text(c[2]);
$("#ms5").text(c[3]);g=Math.round(c[0]/c[3]*100)/100;a=Math.round(c[1]/c[3]*100)/100;c=Math.round(c[2]/c[3]*100)/100;$("#f2").text(g);$("#f3").text(a);$("#f4").text(c);for(a=0;a<num;a++)$("#s"+(a+1)).text(f[a]),$("#m"+(a+1)).text(k[a])})});