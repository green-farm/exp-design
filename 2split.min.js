var num,numA,numB;
$(document).ready(function(){$("#createBtn").click(function(){$("#dataForm").empty();num=parseInt($("#num1").find(":selected").text());numA=parseInt($("#num2").find(":selected").text());numB=parseInt($("#num3").find(":selected").text());var d='<table id="data_table"><tr><th>\u5927\u5340</th><th>\u5c0f\u5340</th><th>',a,c,b;switch(num){case 2:d+="I</th><th>II</th></tr>";break;case 3:d+="I</th><th>II</th><th>III</th></tr>";break;case 4:d+="I</th><th>II</th><th>III</th><th>IV</th></tr>";break;case 5:d+=
"I</th><th>II</th><th>III</th><th>IV</th><th>V</th></tr>"}for(a=0;a<numA;a++)for(d+='<tr><td rowspan="'+numB+'">A'+(a+1)+"</td>",c=0;c<numB;c++){d+="<td>B"+(c+1)+"</td>";for(b=0;b<num;b++)d+='<td><input class="tableData" type="text" id="v'+a+"-"+c+"-"+b+'"/></td>';d+="</tr>"}d+="<tr><th>\u5927\u5340</th><th>\u5c0f\u5340</th><th>";switch(num){case 2:d+="I</th><th>II</th></tr>";break;case 3:d+="I</th><th>II</th><th>III</th></tr>";break;case 4:d+="I</th><th>II</th><th>III</th><th>IV</th></tr>";break;
case 5:d+="I</th><th>II</th><th>III</th><th>IV</th><th>V</th></tr>"}for(a=0;a<numA;a++){d+='<tr><td colspan="2">A'+(a+1)+"</td>";for(b=0;b<num;b++)d+='<td id="a_blo'+a+"-"+b+'"></td>';d+="</tr>"}d+='<tr><td colspan="2">sum</td>';for(b=0;b<num;b++)d+='<td id="block-s'+b+'"></td>';d+='</tr><tr><td colspan="2">mean</td>';for(b=0;b<num;b++)d+='<td id="block-m'+b+'"></td>';d+="</tr></table>";$("#dataForm").append(d);$("#v0-0-0").focus()});$("#anovaBtn").click(function(){var d=Array(numA),a,c,b;for(a=0;a<
numA;a++)d[a]=Array(numB);for(a=0;a<numA;a++)for(c=0;c<numB;c++)d[a][c]=Array(num);for(a=0;a<numA;a++)for(c=0;c<numB;c++)for(b=0;b<num;b++)d[a][c][b]=parseFloat($("#v"+a+"-"+c+"-"+b).val());var g=numA*numB,k=Array(num),h=Array(num),l=Array(numA);for(a=0;a<numA;a++)l[a]=Array(num);for(b=0;b<num;b++){for(a=k[b]=0;a<numA;a++){for(c=l[a][b]=0;c<numB;c++)l[a][b]+=d[a][c][b];$("#a_blo"+a+"-"+b).text(l[a][b]);k[b]+=l[a][b]}$("#block-s"+b).text(k[b]);h[b]=k[b]/g;$("#block-m"+b).text(Math.round(100*h[b])/
100)}g=Array(numA);for(a=0;a<numA;a++)g[a]=Array(numB);for(a=0;a<numA;a++)for(c=0;c<numB;c++){for(b=g[a][c]=0;b<num;b++)g[a][c]+=d[a][c][b];$("#a"+(a+1)+"b"+(c+1)).text(Math.round(100*g[a][c])/100)}var e=0;h=Array(numA);var m=Array(numB);b=Array(numA);var f=Array(numB);for(a=0;a<numA;a++){for(c=h[a]=0;c<numB;c++)h[a]+=g[a][c];$("#sumA"+(a+1)).text(Math.round(100*h[a])/100);b[a]=h[a]/(num*numB);$("#meanA"+(a+1)).text(Math.round(100*b[a])/100);e+=h[a]}$("#sumTot").text(Math.round(100*e)/100);for(c=
0;c<numB;c++){for(a=m[c]=0;a<numA;a++)m[c]+=g[a][c];$("#sumB"+(c+1)).text(Math.round(100*m[c])/100);f[c]=m[c]/(num*numA);$("#meanB"+(c+1)).text(Math.round(100*f[c])/100)}f=Array(7);f[0]=num*numA*numB-1;f[1]=num-1;f[2]=numA-1;f[3]=f[1]*f[2];f[4]=numB-1;f[5]=f[2]*f[4];f[6]=numA*(numB-1)*(num-1);$("#df1").text(f[0]);$("#df2").text(f[1]);$("#df3").text(f[2]);$("#df4").text(f[3]);$("#df5").text(f[4]);$("#df6").text(f[5]);$("#df7").text(f[6]);for(b=e=0;b<num;b++)e+=k[b];var n=e*e/(f[0]+1);e=Array(7);for(a=
e[0]=0;a<numA;a++)for(c=0;c<numB;c++)for(b=0;b<num;b++)e[0]+=d[a][c][b]*d[a][c][b];e[0]-=n;$("#ss1").text(Math.round(100*e[0])/100);for(b=d=0;b<num;b++)d+=k[b]*k[b];e[1]=d/(numA*numB)-n;$("#ss2").text(Math.round(100*e[1])/100);for(a=d=0;a<numA;a++)d+=h[a]*h[a];e[2]=d/(num*numB)-n;$("#ss3").text(Math.round(100*e[2])/100);for(a=d=0;a<numA;a++)for(b=0;b<num;b++)d+=l[a][b]*l[a][b];e[3]=d/numB-n-e[1]-e[2];$("#ss4").text(Math.round(100*e[3])/100);for(c=d=0;c<numB;c++)d+=m[c]*m[c];e[4]=d/(num*numA)-n;$("#ss5").text(Math.round(100*
e[4])/100);for(a=d=0;a<numA;a++)for(c=0;c<numB;c++)d+=g[a][c]*g[a][c];e[5]=d/num-n-e[2]-e[4];$("#ss6").text(Math.round(100*e[5])/100);e[6]=e[0]-e[1]-e[2]-e[3]-e[4]-e[5];$("#ss7").text(Math.round(100*e[6])/100);a=Array(6);a[0]=e[1]/f[1];a[1]=e[2]/f[2];a[2]=e[3]/f[3];a[3]=e[4]/f[4];a[4]=e[5]/f[5];a[5]=e[6]/f[6];$("#ms2").text(Math.round(100*a[0])/100);$("#ms3").text(Math.round(100*a[1])/100);$("#ms4").text(Math.round(100*a[2])/100);$("#ms5").text(Math.round(100*a[3])/100);$("#ms6").text(Math.round(100*
a[4])/100);$("#ms7").text(Math.round(100*a[5])/100);Fblock=a[0]/a[2];Fa=a[1]/a[2];Fb=a[3]/a[5];Fab=a[4]/a[5];$("#f2").text(Math.round(100*Fblock)/100);$("#f3").text(Math.round(100*Fa)/100);$("#f5").text(Math.round(100*Fb)/100);$("#f6").text(Math.round(100*Fab)/100)})});